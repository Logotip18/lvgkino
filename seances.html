<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–µ–∞–Ω—Å—ã - LVG Kino</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #4ecdc4;
            text-decoration: none;
            padding: 10px 20px;
            border: 1px solid #4ecdc4;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .back-link:hover {
            background: rgba(78, 205, 196, 0.1);
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #4ecdc4;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            font-size: 1.2rem;
        }
        
        .movie {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .movie h2 {
            color: #ff6b6b;
            margin-bottom: 15px;
        }
        
        .seance {
            display: inline-block;
            background: rgba(78, 205, 196, 0.2);
            padding: 10px 15px;
            margin: 5px;
            border-radius: 20px;
            text-decoration: none;
            color: white;
            transition: all 0.3s;
        }
        
        .seance:hover {
            background: rgba(78, 205, 196, 0.4);
            transform: translateY(-2px);
        }
        
        .no-seances {
            text-align: center;
            padding: 30px;
            color: #aaa;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        
        <header>
            <h1>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–µ–∞–Ω—Å–æ–≤</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –∏ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è</p>
        </header>
        
        <div id="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ–∞–Ω—Å–æ–≤...</div>
        <div id="seancesContent" style="display: none;"></div>
        <div id="noSeances" class="no-seances" style="display: none;">
            –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ–∞–Ω—Å–æ–≤
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDeX86T2r1K0LRMEyk3UdUF68bfYiTwjiw",
            authDomain: "lvgkino.firebaseapp.com",
            projectId: "lvgkino",
            storageBucket: "lvgkino.firebasestorage.app",
            messagingSenderId: "526810546839",
            appId: "1:526810546839:web:aaf02cb3a91b31cd311fd2"
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–µ–∞–Ω—Å—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadSeances();
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ–∞–Ω—Å–æ–≤ –∏–∑ Firebase
        async function loadSeances() {
            try {
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–µ–∞–Ω—Å—ã
                const seancesSnapshot = await db.collection('seances').orderBy('movie').get();
                
                if (seancesSnapshot.empty) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('noSeances').style.display = 'block';
                    return;
                }
                
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–µ–∞–Ω—Å—ã –ø–æ —Ñ–∏–ª—å–º–∞–º
                const movies = {};
                
                seancesSnapshot.forEach((doc) => {
                    const seance = doc.data();
                    if (!movies[seance.movie]) {
                        movies[seance.movie] = [];
                    }
                    movies[seance.movie].push({
                        id: doc.id,
                        time: seance.time
                    });
                });
                
                // –°–æ–∑–¥–∞–µ–º HTML –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                let html = '';
                
                for (const [movieName, seances] of Object.entries(movies)) {
                    html += `
                        <div class="movie">
                            <h2>üé¨ ${movieName}</h2>
                            <div>
                    `;
                    
                    seances.forEach(seance => {
                        html += `
                            <a href="hall.html?film=${encodeURIComponent(movieName)}&time=${encodeURIComponent(seance.time)}" 
                               class="seance">${seance.time}</a>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                }
                
                document.getElementById('seancesContent').innerHTML = html;
                document.getElementById('loading').style.display = 'none';
                document.getElementById('seancesContent').style.display = 'block';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ–∞–Ω—Å–æ–≤:', error);
                document.getElementById('loading').innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ–∞–Ω—Å–æ–≤';
            }
        }
    </script>
</body>
</html>
